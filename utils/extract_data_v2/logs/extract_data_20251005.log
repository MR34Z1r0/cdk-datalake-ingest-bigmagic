2025-10-05 16:28:50 - __main__ - ERROR - Unexpected Error: DynamoDBMonitor.__init__() missing 1 required positional argument: 'project_name'
Traceback (most recent call last):
  File "D:\WORKSPACE-GIT\VALORX\cdk-datalake-ingest-bigmagic\utils\extract_data_v2\main.py", line 263, in main
    monitor = setup_monitoring(extraction_config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WORKSPACE-GIT\VALORX\cdk-datalake-ingest-bigmagic\utils\extract_data_v2\main.py", line 117, in setup_monitoring
    monitor = MonitorFactory.create(
              ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WORKSPACE-GIT\VALORX\cdk-datalake-ingest-bigmagic\utils\extract_data_v2\monitoring\monitor_factory.py", line 42, in create
    return monitor_class(**config)
           ^^^^^^^^^^^^^^^^^^^^^^^
TypeError: DynamoDBMonitor.__init__() missing 1 required positional argument: 'project_name'
2025-10-05 16:31:05 - datalake-monitor - INFO - DynamoDBLogger inicializado - Tabla: sofia-dev-datalake-logs-ddb, SNS: True
2025-10-05 16:31:05 - datalake-dynamodb-monitor - INFO - DynamoDBMonitor inicializado usando DynamoDBLogger
2025-10-05 16:31:05 - __main__ - INFO - üöÄ Starting Data Extraction Process
2025-10-05 16:31:05 - __main__ - INFO - ‚úÖ Environment validation passed
2025-10-05 16:31:05 - __main__ - INFO - ================================================================================
2025-10-05 16:31:05 - __main__ - INFO - üìã DATA EXTRACTION CONFIGURATION SUMMARY
2025-10-05 16:31:05 - __main__ - INFO - ================================================================================
2025-10-05 16:31:05 - __main__ - INFO - üìä Table: M_COMPANIA
2025-10-05 16:31:05 - __main__ - INFO - üë• Team: apdayc
2025-10-05 16:31:05 - __main__ - INFO - üì° Source: bigmagic
2025-10-05 16:31:05 - __main__ - INFO - üîå Endpoint: PEBDDATA2
2025-10-05 16:31:05 - __main__ - INFO - üåç Environment: DEV
2025-10-05 16:31:05 - __main__ - INFO - üÜï Load Mode: INITIAL
2025-10-05 16:31:05 - __main__ - INFO - üìÅ Format: parquet
2025-10-05 16:31:05 - __main__ - INFO - üßµ Threads: 1
2025-10-05 16:31:05 - __main__ - INFO - üì¶ Chunk Size: 500,000
2025-10-05 16:31:05 - __main__ - INFO - ================================================================================
2025-10-05 16:31:05 - __main__ - INFO - ‚ÑπÔ∏è  Primera carga - Extrae TODO y guarda watermark
2025-10-05 16:31:05 - __main__ - INFO - ================================================================================
2025-10-05 16:31:05 - core.orchestrator - INFO - === BUILDING TABLE CONFIG ===
2025-10-05 16:31:05 - core.orchestrator - INFO - Raw CSV row LOAD_TYPE: 'full'
2025-10-05 16:31:05 - core.orchestrator - INFO - After strip - load_type: 'full'
2025-10-05 16:31:05 - core.orchestrator - INFO - Before force_full_load check - load_type: 'full'
2025-10-05 16:31:05 - core.orchestrator - INFO - force_full_load setting: False
2025-10-05 16:31:05 - core.orchestrator - INFO - Final load_type: 'full'
2025-10-05 16:31:05 - core.orchestrator - INFO - === END BUILDING TABLE CONFIG ===
2025-10-05 16:31:05 - core.orchestrator - INFO - Watermark storage not needed for this strategy
2025-10-05 16:31:05 - bigmagic-monitor - INFO - DynamoDBLogger inicializado - Tabla: sofia-dev-datalake-logs-ddb, SNS: True
2025-10-05 16:31:05 - bigmagic-dynamodb-monitor - INFO - DynamoDBMonitor inicializado usando DynamoDBLogger
2025-10-05 16:31:05 - bigmagic-monitor - INFO - Iniciando procesamiento de tabla M_COMPANIA
2025-10-05 16:31:05 - bigmagic-monitor - INFO - Log registrado en DynamoDB
2025-10-05 16:31:05 - bigmagic-dynamodb-monitor - INFO - Inicio de extracci√≥n registrado
2025-10-05 16:31:05 - core.orchestrator - INFO - === STARTING CONFIGURATION VALIDATION ===
2025-10-05 16:31:05 - core.orchestrator - INFO - Validating strategy configuration...
2025-10-05 16:31:05 - core.orchestrator - INFO - ‚úÖ Strategy validation passed
2025-10-05 16:31:05 - core.orchestrator - INFO - === CONFIGURATION VALIDATION COMPLETED ===
2025-10-05 16:31:05 - core.orchestrator - INFO - fullload strategy - deleting existing files
2025-10-05 16:31:06 - core.orchestrator - INFO - üîç DEBUG Strategy name: 'fullload'
2025-10-05 16:31:06 - core.orchestrator - INFO - üîç DEBUG Partition column: ''
2025-10-05 16:31:06 - core.orchestrator - INFO - üîç DEBUG Watermark storage available: False
2025-10-05 16:31:06 - core.orchestrator - INFO - üîç DEBUG Chunk size: 500000
2025-10-05 16:31:06 - core.orchestrator - INFO - üîç DEBUG Order by: None
2025-10-05 16:31:06 - core.orchestrator - INFO - üîç DEBUG Chunking params: {}
2025-10-05 16:31:06 - core.orchestrator - INFO - üîç Processing chunk 1 with 1 rows
2025-10-05 16:31:06 - core.orchestrator - INFO - üîç DEBUG is_incremental: False
2025-10-05 16:31:06 - core.orchestrator - INFO - üîç DEBUG should_track: False
2025-10-05 16:31:06 - core.orchestrator - INFO - üîç No watermark to save
2025-10-05 16:31:06 - bigmagic-monitor - INFO - Procesamiento exitoso de tabla M_COMPANIA
2025-10-05 16:31:06 - bigmagic-monitor - INFO - Log registrado en DynamoDB
2025-10-05 16:31:06 - bigmagic-dynamodb-monitor - INFO - Extracci√≥n exitosa registrada
2025-10-05 16:31:06 - __main__ - INFO - ================================================================================
2025-10-05 16:31:06 - __main__ - INFO - üéâ EXTRACTION COMPLETED SUCCESSFULLY
2025-10-05 16:31:06 - __main__ - INFO - üìä Records: 1
2025-10-05 16:31:06 - __main__ - INFO - üìÅ Files: 1
2025-10-05 16:31:06 - __main__ - INFO - ‚è±Ô∏è Time: 0.46s
2025-10-05 16:31:06 - __main__ - INFO - üéØ Strategy: fullload
2025-10-05 16:31:06 - __main__ - INFO - ================================================================================
2025-10-05 16:58:22 - datalake-monitor - INFO - DynamoDBLogger inicializado - Tabla: sofia-dev-datalake-logs-ddb, SNS: True
2025-10-05 16:58:22 - datalake-dynamodb-monitor - INFO - DynamoDBMonitor inicializado usando DynamoDBLogger
2025-10-05 16:58:22 - __main__ - INFO - üöÄ Starting Data Extraction Process
2025-10-05 16:58:22 - __main__ - INFO - ‚úÖ Environment validation passed
2025-10-05 16:58:22 - __main__ - INFO - ================================================================================
2025-10-05 16:58:22 - __main__ - INFO - üìã DATA EXTRACTION CONFIGURATION SUMMARY
2025-10-05 16:58:22 - __main__ - INFO - ================================================================================
2025-10-05 16:58:22 - __main__ - INFO - üìä Table: M_COMPANIA
2025-10-05 16:58:22 - __main__ - INFO - üë• Team: apdayc
2025-10-05 16:58:22 - __main__ - INFO - üì° Source: bigmagic
2025-10-05 16:58:22 - __main__ - INFO - üîå Endpoint: PEBDDATA2
2025-10-05 16:58:22 - __main__ - INFO - üåç Environment: DEV
2025-10-05 16:58:22 - __main__ - INFO - üÜï Load Mode: INITIAL
2025-10-05 16:58:22 - __main__ - INFO - üìÅ Format: parquet
2025-10-05 16:58:22 - __main__ - INFO - üßµ Threads: 1
2025-10-05 16:58:22 - __main__ - INFO - üì¶ Chunk Size: 500,000
2025-10-05 16:58:22 - __main__ - INFO - ================================================================================
2025-10-05 16:58:22 - __main__ - INFO - ‚ÑπÔ∏è  Primera carga - Extrae TODO y guarda watermark
2025-10-05 16:58:22 - __main__ - INFO - ================================================================================
2025-10-05 16:58:22 - core.orchestrator - INFO - === BUILDING TABLE CONFIG ===
2025-10-05 16:58:22 - core.orchestrator - INFO - Raw CSV row LOAD_TYPE: 'full'
2025-10-05 16:58:22 - core.orchestrator - INFO - After strip - load_type: 'full'
2025-10-05 16:58:22 - core.orchestrator - INFO - Before force_full_load check - load_type: 'full'
2025-10-05 16:58:22 - core.orchestrator - INFO - force_full_load setting: False
2025-10-05 16:58:22 - core.orchestrator - INFO - Final load_type: 'full'
2025-10-05 16:58:22 - core.orchestrator - INFO - === END BUILDING TABLE CONFIG ===
2025-10-05 16:58:22 - extract.extractors.sql_server_extractor - INFO - ================================================================================
2025-10-05 16:58:22 - extract.extractors.sql_server_extractor - INFO - ESTABLISHING DATABASE CONNECTION (PyMSSQL)
2025-10-05 16:58:22 - extract.extractors.sql_server_extractor - INFO - ================================================================================
2025-10-05 16:58:22 - extract.extractors.sql_server_extractor - INFO - Server: 172.16.0.33
2025-10-05 16:58:22 - extract.extractors.sql_server_extractor - INFO - Database: BDDATA
2025-10-05 16:58:22 - extract.extractors.sql_server_extractor - INFO - User: usr_datalake
2025-10-05 16:58:22 - extract.extractors.sql_server_extractor - INFO - Port: 1433
2025-10-05 16:58:22 - extract.extractors.sql_server_extractor - INFO - ‚úÖ PyMSSQL connection established
2025-10-05 16:58:22 - extract.extractors.sql_server_extractor - INFO - ================================================================================
2025-10-05 16:58:22 - extract.extractors.sql_server_extractor - INFO - ‚úÖ Database connection test successful (PyMSSQL)
2025-10-05 16:58:23 - core.orchestrator - INFO - Watermark storage not needed for this strategy
2025-10-05 16:58:23 - bigmagic-monitor - INFO - DynamoDBLogger inicializado - Tabla: sofia-dev-datalake-logs-ddb, SNS: True
2025-10-05 16:58:23 - bigmagic-dynamodb-monitor - INFO - DynamoDBMonitor inicializado usando DynamoDBLogger
2025-10-05 16:58:23 - bigmagic-monitor - INFO - Iniciando procesamiento de tabla M_COMPANIA
2025-10-05 16:58:23 - bigmagic-monitor - INFO - Log registrado en DynamoDB
2025-10-05 16:58:23 - bigmagic-dynamodb-monitor - INFO - Inicio de extracci√≥n registrado
2025-10-05 16:58:23 - core.orchestrator - INFO - === STARTING CONFIGURATION VALIDATION ===
2025-10-05 16:58:23 - core.orchestrator - INFO - Validating strategy configuration...
2025-10-05 16:58:23 - core.orchestrator - INFO - ‚úÖ Strategy validation passed
2025-10-05 16:58:23 - core.orchestrator - INFO - === CONFIGURATION VALIDATION COMPLETED ===
2025-10-05 16:58:23 - core.orchestrator - INFO - fullload strategy - deleting existing files
2025-10-05 16:58:23 - core.orchestrator - INFO - üîç DEBUG Strategy name: 'fullload'
2025-10-05 16:58:23 - core.orchestrator - INFO - üîç DEBUG Partition column: ''
2025-10-05 16:58:23 - core.orchestrator - INFO - üîç DEBUG Watermark storage available: False
2025-10-05 16:58:23 - core.orchestrator - INFO - üîç DEBUG Chunk size: 500000
2025-10-05 16:58:23 - core.orchestrator - INFO - üîç DEBUG Order by: None
2025-10-05 16:58:23 - core.orchestrator - INFO - üîç DEBUG Chunking params: {}
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - ================================================================================
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - DATA EXTRACTION STARTED
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - ================================================================================
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - Extraction mode: SINGLE QUERY
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - --------------------------------------------------------------------------------
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - SQL Query:
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - SELECT rtrim(ltrim(compania)) as id, dbo.func_cas_todatetime(fecultmod, horultimod) lastmodifydate, compania, replace(replace(nombre, char(13), ''), char(10), '') nombre, cast(cast(persona as int) as varchar(20)) persona, tipovia, replace(replace(direccion, char(13), ''), char(10), '') direccion, rtrim(ltrim(pais)) pais, departamen, provincia, zonapostal, telefono1, telefono2, telefono3, telefono4, fax, flgtipocia, ruc, nota, regigv, estado, feccrea, horcrea, usucrea, fecultmod, horultimod, ultusumod, abrevbco, case when aprobreq = 0x46 then 'F' when aprobreq = 0x54 then 'T' end aprobreq, case when aproboco = 0x46 then 'F' when aproboco = 0x54 then 'T' end aproboco, ipenlace, case when flgctrfaoc = 0x46 then 'F' when flgctrfaoc = 0x54 then 'T' end flgctrfaoc, case when flgrestart = 0x46 then 'F' when flgrestart = 0x54 then 'T' end flgrestart, case when flgaprogj = 0x46 then 'F' when flgaprogj = 0x54 then 'T' end flgaprogj, cast(cast(cantemple as int) as varchar(20)) cantemple, sucprin, coidioma, intercom, flgbi FROM mcompa1f
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - ================================================================================
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - üîç Query Attempt 1/3
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - Query preview: SELECT rtrim(ltrim(compania)) as id, dbo.func_cas_todatetime(fecultmod, horultimod) lastmodifydate, compania, replace(replace(nombre, char(13), ''), c...
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - ‚úÖ Query executed successfully
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - Execution time: 0.02s
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - Rows returned: 1
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - Columns: 39
2025-10-05 16:58:23 - extract.extractors.sql_server_extractor - INFO - Yielding single result with 1 rows
2025-10-05 16:58:23 - core.orchestrator - INFO - üîç Processing chunk 1 with 1 rows
2025-10-05 16:58:24 - extract.extractors.sql_server_extractor - INFO - ================================================================================
2025-10-05 16:58:24 - extract.extractors.sql_server_extractor - INFO - DATA EXTRACTION COMPLETED
2025-10-05 16:58:24 - extract.extractors.sql_server_extractor - INFO - ================================================================================
2025-10-05 16:58:24 - core.orchestrator - INFO - üîç DEBUG is_incremental: False
2025-10-05 16:58:24 - core.orchestrator - INFO - üîç DEBUG should_track: False
2025-10-05 16:58:24 - core.orchestrator - INFO - üîç No watermark to save
2025-10-05 16:58:24 - bigmagic-monitor - INFO - Procesamiento exitoso de tabla M_COMPANIA
2025-10-05 16:58:24 - bigmagic-monitor - INFO - Log registrado en DynamoDB
2025-10-05 16:58:24 - bigmagic-dynamodb-monitor - INFO - Extracci√≥n exitosa registrada
2025-10-05 16:58:24 - extract.extractors.sql_server_extractor - INFO - üîí PyMSSQL connection closed
2025-10-05 16:58:24 - __main__ - INFO - ================================================================================
2025-10-05 16:58:24 - __main__ - INFO - üéâ EXTRACTION COMPLETED SUCCESSFULLY
2025-10-05 16:58:24 - __main__ - INFO - üìä Records: 1
2025-10-05 16:58:24 - __main__ - INFO - üìÅ Files: 1
2025-10-05 16:58:24 - __main__ - INFO - ‚è±Ô∏è Time: 0.58s
2025-10-05 16:58:24 - __main__ - INFO - üéØ Strategy: fullload
2025-10-05 16:58:24 - __main__ - INFO - ================================================================================
